{".class": "MypyFile", "_fullname": "jax.experimental.multihost_utils", "future_import_flags": [], "is_partial_stub_package": false, "is_stub": false, "names": {".class": "SymbolTable", "Any": {".class": "SymbolTableNode", "cross_ref": "typing.Any", "kind": "Gdef"}, "Optional": {".class": "SymbolTableNode", "cross_ref": "typing.Optional", "kind": "Gdef"}, "P": {".class": "SymbolTableNode", "cross_ref": "jax._src.partition_spec.PartitionSpec", "kind": "Gdef"}, "__annotations__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["is_ready"], "fullname": "jax.experimental.multihost_utils.__annotations__", "name": "__annotations__", "type": {".class": "Instance", "args": ["builtins.str", {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 6}], "type_ref": "builtins.dict"}}}, "__doc__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["is_ready"], "fullname": "jax.experimental.multihost_utils.__doc__", "name": "__doc__", "type": "builtins.str"}}, "__file__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["is_ready"], "fullname": "jax.experimental.multihost_utils.__file__", "name": "__file__", "type": "builtins.str"}}, "__name__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["is_ready"], "fullname": "jax.experimental.multihost_utils.__name__", "name": "__name__", "type": "builtins.str"}}, "__package__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["is_ready"], "fullname": "jax.experimental.multihost_utils.__package__", "name": "__package__", "type": "builtins.str"}}, "_flatten_pspecs": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Decorator", "func": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["name", "in_tree", "pspecs_thunk"], "flags": ["is_decorated"], "fullname": "jax.experimental.multihost_utils._flatten_pspecs", "name": "_flatten_pspecs", "type": null}, "is_overload": false, "var": {".class": "Var", "flags": ["is_ready"], "fullname": null, "name": "_flatten_pspecs", "type": {".class": "Instance", "args": [{".class": "AnyType", "missing_import_name": null, "source_any": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_of_any": 7}], "type_ref": "functools._lru_cache_wrapper"}}}}, "_global_to_local_aval": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Decorator", "func": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["global_aval", "mesh", "pspec"], "flags": ["is_decorated"], "fullname": "jax.experimental.multihost_utils._global_to_local_aval", "name": "_global_to_local_aval", "type": null}, "is_overload": false, "var": {".class": "Var", "flags": ["is_ready"], "fullname": null, "name": "_global_to_local_aval", "type": {".class": "Instance", "args": [{".class": "AnyType", "missing_import_name": null, "source_any": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_of_any": 7}], "type_ref": "functools._lru_cache_wrapper"}}}}, "_gtl_lowering": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 3, 3], "arg_names": ["ctx", "x", "global_mesh", "pspec"], "flags": [], "fullname": "jax.experimental.multihost_utils._gtl_lowering", "name": "_gtl_lowering", "type": null}}, "_handle_array_process_allgather": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0], "arg_names": ["inp", "tiled"], "flags": [], "fullname": "jax.experimental.multihost_utils._handle_array_process_allgather", "name": "_handle_array_process_allgather", "type": null}}, "_identity_fn": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["x"], "flags": [], "fullname": "jax.experimental.multihost_utils._identity_fn", "name": "_identity_fn", "type": null}}, "_local_to_global_aval": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Decorator", "func": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["local_aval", "mesh", "pspec"], "flags": ["is_decorated"], "fullname": "jax.experimental.multihost_utils._local_to_global_aval", "name": "_local_to_global_aval", "type": null}, "is_overload": false, "var": {".class": "Var", "flags": ["is_ready"], "fullname": null, "name": "_local_to_global_aval", "type": {".class": "Instance", "args": [{".class": "AnyType", "missing_import_name": null, "source_any": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_of_any": 7}], "type_ref": "functools._lru_cache_wrapper"}}}}, "_ltg_lowering": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 3, 3], "arg_names": ["ctx", "x", "global_mesh", "pspec"], "flags": [], "fullname": "jax.experimental.multihost_utils._ltg_lowering", "name": "_ltg_lowering", "type": null}}, "_psum": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["x"], "flags": [], "fullname": "jax.experimental.multihost_utils._psum", "name": "_psum", "type": {".class": "CallableType", "arg_kinds": [0], "arg_names": ["x"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "_psum", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "type_guard": null, "variables": []}}}, "ad": {".class": "SymbolTableNode", "cross_ref": "jax._src.interpreters.ad", "kind": "Gdef"}, "array": {".class": "SymbolTableNode", "cross_ref": "jax._src.array", "kind": "Gdef"}, "assert_equal": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 1], "arg_names": ["in_tree", "fail_message"], "flags": [], "fullname": "jax.experimental.multihost_utils.assert_equal", "name": "assert_equal", "type": {".class": "CallableType", "arg_kinds": [0, 1], "arg_names": ["in_tree", "fail_message"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "builtins.str"], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "assert_equal", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_guard": null, "variables": []}}}, "batching": {".class": "SymbolTableNode", "cross_ref": "jax._src.interpreters.batching", "kind": "Gdef"}, "broadcast_one_to_all": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 1], "arg_names": ["in_tree", "is_source"], "flags": [], "fullname": "jax.experimental.multihost_utils.broadcast_one_to_all", "name": "broadcast_one_to_all", "type": {".class": "CallableType", "arg_kinds": [0, 1], "arg_names": ["in_tree", "is_source"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, {".class": "UnionType", "items": ["builtins.bool", {".class": "NoneType"}]}], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "broadcast_one_to_all", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "type_guard": null, "variables": []}}}, "core": {".class": "SymbolTableNode", "cross_ref": "jax._src.core", "kind": "Gdef"}, "distributed": {".class": "SymbolTableNode", "cross_ref": "jax._src.distributed", "kind": "Gdef"}, "global_array_to_host_local_array": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["global_inputs", "global_mesh", "pspecs"], "flags": [], "fullname": "jax.experimental.multihost_utils.global_array_to_host_local_array", "name": "global_array_to_host_local_array", "type": {".class": "CallableType", "arg_kinds": [0, 0, 0], "arg_names": ["global_inputs", "global_mesh", "pspecs"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "jax._src.mesh.Mesh", {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "global_array_to_host_local_array", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_guard": null, "variables": []}}}, "global_array_to_host_local_array_impl": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 3, 3], "arg_names": ["arr", "global_mesh", "pspec"], "flags": [], "fullname": "jax.experimental.multihost_utils.global_array_to_host_local_array_impl", "name": "global_array_to_host_local_array_impl", "type": {".class": "CallableType", "arg_kinds": [0, 3, 3], "arg_names": ["arr", "global_mesh", "pspec"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "jax._src.mesh.Mesh", {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "global_array_to_host_local_array_impl", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_guard": null, "variables": []}}}, "global_array_to_host_local_array_p": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["has_explicit_value"], "fullname": "jax.experimental.multihost_utils.global_array_to_host_local_array_p", "name": "global_array_to_host_local_array_p", "type": "jax._src.core.Primitive"}}, "gtl_abstract_eval": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 3, 3], "arg_names": ["arr", "global_mesh", "pspec"], "flags": [], "fullname": "jax.experimental.multihost_utils.gtl_abstract_eval", "name": "gtl_abstract_eval", "type": null}}, "host_local_array_to_global_array": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["local_inputs", "global_mesh", "pspecs"], "flags": [], "fullname": "jax.experimental.multihost_utils.host_local_array_to_global_array", "name": "host_local_array_to_global_array", "type": {".class": "CallableType", "arg_kinds": [0, 0, 0], "arg_names": ["local_inputs", "global_mesh", "pspecs"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "jax._src.mesh.Mesh", {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "host_local_array_to_global_array", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_guard": null, "variables": []}}}, "host_local_array_to_global_array_impl": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 3, 3], "arg_names": ["arr", "global_mesh", "pspec"], "flags": [], "fullname": "jax.experimental.multihost_utils.host_local_array_to_global_array_impl", "name": "host_local_array_to_global_array_impl", "type": {".class": "CallableType", "arg_kinds": [0, 3, 3], "arg_names": ["arr", "global_mesh", "pspec"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "jax._src.mesh.Mesh", {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "host_local_array_to_global_array_impl", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_guard": null, "variables": []}}}, "host_local_array_to_global_array_p": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["has_explicit_value"], "fullname": "jax.experimental.multihost_utils.host_local_array_to_global_array_p", "name": "host_local_array_to_global_array_p", "type": "jax._src.core.Primitive"}}, "jax": {".class": "SymbolTableNode", "cross_ref": "jax", "kind": "Gdef"}, "jnp": {".class": "SymbolTableNode", "cross_ref": "jax.numpy", "kind": "Gdef"}, "lru_cache": {".class": "SymbolTableNode", "cross_ref": "functools.lru_cache", "kind": "Gdef"}, "ltg_abstract_eval": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 3, 3], "arg_names": ["arr", "global_mesh", "pspec"], "flags": [], "fullname": "jax.experimental.multihost_utils.ltg_abstract_eval", "name": "ltg_abstract_eval", "type": null}}, "ltg_batcher": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 0, 0, 0, 0, 0, 0, 0], "arg_names": ["insert_axis", "spmd_axis_name", "axis_size", "axis_name", "main_type", "vals_in", "dims_in", "global_mesh", "pspec"], "flags": [], "fullname": "jax.experimental.multihost_utils.ltg_batcher", "name": "ltg_batcher", "type": null}}, "mlir": {".class": "SymbolTableNode", "cross_ref": "jax._src.interpreters.mlir", "kind": "Gdef"}, "np": {".class": "SymbolTableNode", "cross_ref": "numpy", "kind": "Gdef"}, "partial": {".class": "SymbolTableNode", "cross_ref": "functools.partial", "kind": "Gdef"}, "pjit": {".class": "SymbolTableNode", "cross_ref": "jax._src.pjit.pjit", "kind": "Gdef"}, "pjit_lib": {".class": "SymbolTableNode", "cross_ref": "jax._src.pjit", "kind": "Gdef"}, "process_allgather": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 1], "arg_names": ["in_tree", "tiled"], "flags": [], "fullname": "jax.experimental.multihost_utils.process_allgather", "name": "process_allgather", "type": {".class": "CallableType", "arg_kinds": [0, 1], "arg_names": ["in_tree", "tiled"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "builtins.bool"], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "process_allgather", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 2}, "type_guard": null, "variables": []}}}, "pxla": {".class": "SymbolTableNode", "cross_ref": "jax._src.interpreters.pxla", "kind": "Gdef"}, "reached_preemption_sync_point": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["step_id"], "flags": [], "fullname": "jax.experimental.multihost_utils.reached_preemption_sync_point", "name": "reached_preemption_sync_point", "type": {".class": "CallableType", "arg_kinds": [0], "arg_names": ["step_id"], "arg_types": ["builtins.int"], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "reached_preemption_sync_point", "ret_type": "builtins.bool", "type_guard": null, "variables": []}}}, "safe_zip": {".class": "SymbolTableNode", "cross_ref": "jax._src.util.safe_zip", "kind": "Gdef"}, "sharding_impls": {".class": "SymbolTableNode", "cross_ref": "jax._src.sharding_impls", "kind": "Gdef"}, "sync_global_devices": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["name"], "flags": [], "fullname": "jax.experimental.multihost_utils.sync_global_devices", "name": "sync_global_devices", "type": {".class": "CallableType", "arg_kinds": [0], "arg_names": ["name"], "arg_types": ["builtins.str"], "bound_args": [], "def_extras": {"first_arg": null}, "fallback": "builtins.function", "from_concatenate": false, "implicit": false, "is_ellipsis_args": false, "name": "sync_global_devices", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "type_guard": null, "variables": []}}}, "tree_flatten": {".class": "SymbolTableNode", "cross_ref": "jax._src.tree_util.tree_flatten", "kind": "Gdef"}, "tree_map": {".class": "SymbolTableNode", "cross_ref": "jax._src.tree_util.tree_map", "kind": "Gdef"}, "tree_unflatten": {".class": "SymbolTableNode", "cross_ref": "jax._src.tree_util.tree_unflatten", "kind": "Gdef"}, "xla": {".class": "SymbolTableNode", "cross_ref": "jax.interpreters.xla", "kind": "Gdef"}, "zlib": {".class": "SymbolTableNode", "cross_ref": "zlib", "kind": "Gdef"}}, "path": "/opt/homebrew/Caskroom/miniconda/base/envs/main/lib/python3.10/site-packages/jax/experimental/multihost_utils.py"}